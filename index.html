<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KIBO | Block Coding</title>
    <link rel="icon" type="image" href="asset/Logo.png"/>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet"/>
    <style>
        body {
            font-family: 'Prompt', sans-serif; background-color: #f0fdf4;
            background-color: #e0f2fe;
            background-image: url('asset/HomeBg.png'); 
            background-size: cover;
            background-position: center bottom;
            background-repeat: no-repeat;
            background-attachment: fixed;
            min-height: 100vh;
            overflow-x: hidden;
            margin: 0;
        }

        .bg-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(255, 255, 255, 0.4);
            z-index: 0;
            pointer-events: none;
        }
        .block-item { 
            cursor: grab; 
            transition: transform 0.2s, box-shadow 0.2s; 
            width: fit-content;
            margin: 0 auto;
        }
    </style>
</head>
<body class="min-h-screen p-4 md:p-8 flex flex-col items-center">

    <!-- 1. HOME SCREEN VIEW -->
    <div id="view-home" class="view-section active max-w-2xl w-full flex-col items-center justify-center text-center mt-10">
        <h1 class="text-4xl md:text-5xl font-bold text-blue-700 mb-4" style="color: azure;">KIBO<br>Block Coding</h1>
        <p class="text-lg text-gray-600 mb-10 px-4" style="color: rgb(214, 225, 240);">‡∏ù‡∏∂‡∏Å‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏¥‡∏î‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÅ‡∏ö‡∏ö Block Coding ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞ ‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢</p>
        <button onclick="showView('view-levels')" style="background-color: rgb(84, 153, 255);" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-10 rounded-full shadow-lg transition-transform transform hover:scale-105 text-xl">
            ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö!
        </button>
    </div>

    <!-- 2. LEVEL SELECTION VIEW -->
    <div id="view-levels" class="view-section flex-col max-w-4xl w-full">
        <div class="flex justify-between items-center mb-8">
            <button onclick="showView('view-home')" style="color: azure;" class="text-blue-700 font-medium hover:text-blue-900 flex items-center gap-1">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg> ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
            </button>
            <h2 class="text-3xl font-bold text-gray-800 text-center" style="color: azure;">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à (Levels)</h2>
            <div class="w-24"></div>
        </div>
        <div id="levels-container" class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <!-- Level cards generated by JS -->
        </div>
    </div>

    <!-- 3. STORYTELLING VIEW -->
    <div id="view-story" style="background: rgba(156, 176, 237, 0.4); backdrop-filter: blur(2px);" class="view-section flex-col items-center justify-center max-w-2xl w-full text-center mt-5 p-8 bg-slate-900 rounded-3xl shadow-2xl text-white min-h-[500px] border-4 border-slate-700">
        <div class="text-7xl mb-4" id="story-icon">üè¢</div>
        <h2 class="text-3xl font-bold mb-8 text-blue-300" id="story-title">Mission Briefing</h2>
        
        <div class="bg-black bg-opacity-50 p-6 rounded-xl border border-slate-600 min-h-[160px] w-full text-left font-mono text-lg leading-relaxed relative cursor-pointer" onclick="skipTypewriter()">
            <span id="story-text" class="text-green-400"></span><span id="story-cursor" class="cursor-blink font-bold">_</span>
            <div class="absolute bottom-2 right-3 text-xs text-slate-500">(‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)</div>
        </div>

        <button id="start-mission-btn" onclick="showView('view-puzzle')" class="mt-10 bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-10 rounded-full shadow-[0_0_15px_rgba(37,99,235,0.5)] transition-all transform hover:scale-105 opacity-0 pointer-events-none">
            ‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö! ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏±‡πà‡∏á‡∏Å‡∏≤‡∏£
        </button>
    </div>

    <!-- 4. PUZZLE VIEW -->
    <div id="view-puzzle" style="background: rgba(109, 130, 193, 0.4); backdrop-filter: blur(8px);" class="view-section flex-col max-w-6xl w-full bg-white rounded-2xl shadow-xl overflow-hidden">
        <div class="bg-blue-600 text-white p-4 flex justify-between items-center" style="background: rgba(81, 111, 200, 0.427); backdrop-filter: blur(8px);">
            <button onclick="showView('view-levels')" class="text-blue-100 hover:text-white flex items-center gap-1 text-sm font-medium">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg> ‡πÄ‡∏°‡∏ô‡∏π‡∏î‡πà‡∏≤‡∏ô
            </button>
            <h1 id="puzzle-title" class="text-xl font-bold">‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏ó‡∏µ‡πà...</h1>
            <button onclick="startStory(currentLevel)" class="text-blue-100 hover:text-white flex items-center gap-1 text-sm font-medium">‡∏≠‡πà‡∏≤‡∏ô‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
        </div>

        <div class="p-4 md:p-6 grid grid-cols-1 lg:grid-cols-12 gap-6">
            <!-- Left Column: Instructions & Blocks -->
            <div class="bg-gray-50 p-5 rounded-xl border border-gray-200 flex flex-col lg:col-span-5 h-full" style="background: rgba(78, 107, 193, 0.374); backdrop-filter: blur(8px); color: azure;">
                <h2 class="text-lg font-semibold mb-2 text-gray-800" style="color: azure;">1. ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ (Goal)</h2>
                <p id="puzzle-desc" class="text-sm text-white-700 mb-5 font-medium bg-white p-4 rounded border-l-4 border-blue-500 shadow-sm leading-relaxed" style="background: rgba(3, 13, 43, 0.459); backdrop-filter: blur(10px);"></p>
                
                <h2 class="text-lg font-semibold mb-3 text-gray-800" style="color: azure;">2. ‡∏•‡∏≤‡∏Å‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÑ‡∏õ‡∏ß‡∏≤‡∏á</h2>
                <div class="flex flex-col gap-3 flex-1 bg-gray-100 p-4 rounded-lg border-2 border-dashed border-gray-300 overflow-y-auto max-h-[500px]" id="block-container" style="background: rgba(3, 13, 43, 0.459); backdrop-filter: blur(10px);">
                    <!-- Draggable Blocks generated by JS -->
                </div>
            </div>

            <!-- Right Column: Dynamic Workspace -->
            <div class="bg-blue-50 p-5 rounded-xl border border-blue-200 flex flex-col lg:col-span-7 h-full" style="background: rgba(78, 107, 193, 0.374); backdrop-filter: blur(8px);">
                <h2 class="text-xl font-semibold mb-4 text-blue-800 flex items-center gap-2" style="color: azure;">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg>
                    3. ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (Workspace)
                </h2>
                
                <div id="workspace-container" class="bg-white border-2 border-blue-400 rounded-xl p-4 shadow-inner flex-1 flex flex-col justify-start min-h-[400px]" style="background: rgba(3, 13, 43, 0.459); backdrop-filter: blur(10px); color: #e0f2fe;">
                    <!-- HTML structure dynamically injected here based on level type -->
                </div>

                <button id="check-btn" onclick="runSimulation()" class="mt-6 w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-4 rounded-xl shadow-[0_4px_0_#1d4ed8] active:translate-y-1 active:shadow-none transition-all flex justify-center items-center gap-2 text-lg">
                    ‚ñ∂ ‡∏£‡∏±‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° (RUN)
                </button>
            </div>
        </div>
    </div>

    <!-- Simulation Modal -->
    <div id="simModal" class="fixed inset-0 bg-black bg-opacity-80 z-50 hidden flex-col justify-center items-center">
        <div class="bg-white rounded-2xl p-6 md:p-8 max-w-md w-full mx-4 text-center shadow-2xl flex flex-col items-center relative">
             <button id="sim-close-x" onclick="closeSimulation(window.currentSimResult)" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 hidden transition-colors">
                 <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
             </button>
             <h3 class="text-2xl font-bold text-gray-800 mb-4 border-b-2 border-gray-200 pb-2 w-full">‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</h3>
             
             <div class="bg-indigo-50 text-indigo-800 p-3 rounded-lg w-full mb-4 font-semibold text-sm border border-indigo-200 shadow-inner" id="sim-trigger">
                 ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô...
             </div>

             <div class="text-left w-full mb-6 bg-gray-50 p-4 rounded-lg text-sm font-mono text-gray-700 border border-gray-200 shadow-inner min-h-[100px] max-h-60 overflow-y-auto" id="sim-log-container">
                 <!-- Logs injected dynamically -->
             </div>

             <!-- Visual Output Window -->
             <div id="sim-visual-container" class="h-32 w-32 flex items-center justify-center rounded-2xl bg-slate-800 mb-4 overflow-hidden border-4 border-slate-300 shadow-inner relative mx-auto">
                  <div id="sim-visual-icon" class="text-6xl transition-all duration-700 transform scale-100 flex items-center justify-center w-full h-full text-center">‚è≥</div>
             </div>
             <p id="sim-visual-text" class="text-lg font-bold text-gray-500 h-8">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á...</p>

             <div id="sim-action-buttons" class="mt-4 w-full flex gap-3 hidden">
                 <button id="sim-btn-retry" onclick="closeSimulation(false)" class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-3 px-4 rounded-lg transition-colors hidden">‡∏õ‡∏¥‡∏î (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏´‡∏°‡πà)</button>
                 <button id="sim-btn-next" onclick="closeSimulation(true)" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition-colors hidden shadow-md">‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠</button>
             </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden justify-center items-center">
        <div class="bg-white rounded-2xl p-8 max-w-sm w-full mx-4 text-center shadow-2xl transform transition-all scale-95 opacity-0 duration-300" id="modalContent">
            <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-blue-100 mb-6">
                <svg class="h-10 w-10 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
            </div>
            <h3 class="text-2xl font-bold text-gray-900 mb-2">‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏°‡∏≤‡∏Å!</h3>
            <p id="modal-desc" class="text-gray-600 mb-6">‡∏ï‡∏£‡∏£‡∏Å‡∏∞‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Ñ‡∏∏‡∏ì‡∏ú‡πà‡∏≤‡∏ô‡∏î‡πà‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß!</p>
            <button id="next-level-btn" onclick="goToNextLevel()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg shadow transition-colors mb-2">‡πÑ‡∏õ‡∏î‡πà‡∏≤‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
            <button onclick="window.open('https://simulator.kidbright.space/', '_blank')" class="w-full bg-gray-100 hover:bg-gray-200 text-gray-800 font-bold py-3 px-4 rounded-lg shadow-sm transition-colors text-sm">‡∏ô‡∏≥‡πÑ‡∏õ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÉ‡∏ô KidBright IDE</button>
        </div>
    </div>

    <div id="errorToast" class="fixed bottom-5 right-5 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg opacity-0 transition-opacity duration-300 pointer-events-none z-50 flex items-center gap-2 font-medium">
        <span>‚ùå</span> <span id="toast-msg">‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î</span>
    </div>

    <script src="js/script.js"></script>
</body>
</html>
